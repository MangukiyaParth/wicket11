<IfModule mod_php5.c>
    php_flag session.auto_start 1
</IfModule>

<Files .env>
    Order allow,deny
    Deny from all
</Files>

RewriteEngine On

# 1. FIRST handle static files - VERY IMPORTANT this comes first
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# 2. Then handle cache-busting (if needed)
RewriteRule ^(.*)\.[\d]{10}\.(css|js)$ $1.$2 [L]

# 3. Then HTTPS redirect (if needed)
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !^localhost [NC]
RewriteCond %{HTTP_HOST} !^192\. [NC]
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# 4. Finally, your PHP routes
RewriteRule ^login/?$ login.php [L]
RewriteRule ^logout/?$ logout.php [L]
RewriteRule ^page/([^/]+)/?$ manage.php?id=$1 [NC,L]